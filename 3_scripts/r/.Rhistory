scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none')
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour = 'black', fill = "white",size = 1),
strip.text.x = element_text(size = 12, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('') + ylab('Phylum')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab()+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
ylab('Phylum') + xlab()+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"),
axis.title.y = element_text(vjust =0.3))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
ylab('Phylum') + xlab()+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
ylab('Phylum') + xlab()+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
ylab('Phylum') + xlab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,6),units="points"),
axis.title.y = element_text(vjust =0.3))
p
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
ylab('Phylum') + xlab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-5,6),units="points"),
axis.title.y = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-5,6),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(-5,5,-5,6),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(-10,5,-5,6),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-5,1),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,-20),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-30,1),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-25,1),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-25,1),units="points"),
axis.title.x = element_text(vjust =0.3))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-25,1),units="points"),
axis.title.x = element_text(vjust =0.3, face='bold'))
# panel.border = element_blank(),
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-25,1),units="points"),
axis.title.x = element_text(size=14, vjust =0.3, face='bold'))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/5, 4/5)))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/7, 6/7)))
?grid.arrange
g <- grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
ggsave(g, file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=9, height=6)
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=9, height=6)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=12, height=6)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=12, height=6)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=12, height=6)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour = 'black', fill = "white",size = 1),
strip.text.x = element_text(size = 9, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
phy$fac <- 1
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-25,1),units="points"),
axis.title.x = element_text(size=14, vjust =0.3, face='bold'))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=12, height=6)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
## Join both plots
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=13, height=7)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(fill = "white",size = 1),
strip.text.x = element_text(size = 9, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
## Join both plots
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=13, height=7)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
# Create plot bar by order
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour='white', fill = "white",size = 1),
strip.text.x = element_text(size = 9, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=13, height=7)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour='white', fill = "white",size = 1),
strip.text.x = element_text(size = 8, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
## Join both plots
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=13, height=7)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
# Create plot bar by order
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour='white', fill = "white",size = 1),
strip.text.x = element_text(size = 9, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.margin = unit(2, "lines"),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour='white', fill = "white",size = 1),
strip.text.x = element_text(size = 9, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
jpg(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.jpg',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
jpeg(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.jpg',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.jpg',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.png',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.png',sep=''))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
?png
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.png',sep=''), bg = "transparent", width = 1000, height = 560,)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.png',sep=''), bg = "transparent", width = 1000, height = 560,)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.margin = unit(1.2, "lines"),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour='white', fill = "white",size = 1),
strip.text.x = element_text(size = 9, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
phy$fac <- 1
p <- ggplot(phy, aes(x=fac, y=per, fill=phylum, width=.3)) +
geom_bar(stat = "identity", width=.2) +
xlim(0.8,1.2) + coord_flip()+
scale_fill_manual(values=c('#43a2ca','red','black')) +
theme_bw() +
xlab('Phylum') + ylab('')+
theme(panel.grid=element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
legend.position = 'none',
plot.margin = unit(c(1,5,-25,1),units="points"),
axis.title.x = element_text(size=14, vjust =0.3, face='bold'))
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.png',sep=''), bg = "transparent", width = 1000, height = 560,)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
# Create plot bar by order
o <-  ggplot(ord, aes(x=Order, y=per)) +
geom_bar(stat = "identity", fill='#43a2ca') + scale_y_continuous(limits=c(0, 50)) +
facet_grid(~Class, drop=TRUE, space = "free", scales = "free_x") +
theme_bw() +
theme(panel.grid=element_blank(),
panel.margin = unit(1.2, "lines"),
panel.border = element_rect(colour = 'black', linetype = "dotted"),
axis.ticks = element_blank(), axis.text.x = element_text(angle=90, vjust=0.5, size=12),
strip.background = element_rect(colour='white', fill = "white",size = 1),
strip.text.x = element_text(size = 8, face='bold'),
plot.margin = unit(c(0,5,1,1),units="points"))+
ylab('% total') + xlab('Orders') +
geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.9, size=4)
o
## Join both plots
pdf(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.pdf',sep=''), width=15, height=8)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
png(file=paste(di, '/8_figures/taxonomicCoverage/orderCov.png',sep=''), bg = "transparent", width = 1000, height = 560,)
grid.arrange(arrangeGrob(p, o, ncol=1, nrow=2, heights = c(1/6, 5/6)))
dev.off()
View(phy)
View(phy)
library('rmarkdown')
library('knitr')
setwd('/Users/ajpelu/Dropbox/MS/MS_DP_Borreguiles/git/BorreguilesDP/3_scripts/r/')
rmarkdown::render('gbif_borreguiles_006_plot_phylum_class.Rmd', 'all')
